<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-AI Response App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
        }

        #app {
            background-color: #fff;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .top-bar button {
            background-color: #fff;
            color: #007bff;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        .top-bar button:hover {
            background-color: #e0e0e0;
        }

        .responses {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
            overflow-y: auto;
            padding: 20px;
        }

        .chat-message, .model-response {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            position: relative;
        }

        .response {
            white-space: pre-wrap;
            margin-top: 10px;
            max-height: 200px;
            overflow-y: auto;
        }

        .loading {
            color: #888;
        }

        .input-container {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            border-top: 1px solid #ddd;
            background-color: #fff;
        }

        input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            outline: none;
        }

        button {
            padding: 10px;
            margin-left: 10px;
            background-color: #007bff;
            border: none;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        .toggle-button {
            background-color: #6c757d;
            margin-right: 10px;
        }

        .toggle-button:hover {
            background-color: #5a6268;
        }

        .model-select {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 10px;
            display: none;
            flex-direction: column;
        }

        .model-select.show {
            display: flex;
        }

        .model-select button {
            margin-top: 10px;
            width: 100%;
        }

        .model-select .apply-button {
            align-self: center;
            width: 50%;
        }

        .model-select label {
            display: block;
            margin-bottom: 5px;
        }

        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .copy-button:hover {
            background-color: #0056b3;
        }

        .history-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 80%;
            max-width: 600px;
            max-height: 80%;
            overflow-y: auto;
            display: none;
            flex-direction: column;
            z-index: 1000;
        }

        .history-modal.show {
            display: flex;
        }

        .history-modal .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .history-modal .modal-header button {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        .history-modal .modal-header button:hover {
            background-color: #0056b3;
        }

        .history-modal .chat-history {
            flex: 1;
            overflow-y: auto;
        }

        .history-modal .chat-history .history-entry {
            margin-bottom: 10px;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
            background-color: #f9f9f9;
            cursor: pointer;
        }

        .history-modal .chat-history .history-entry:hover {
            background-color: #e0e0e0;
        }

        .history-entry-buttons {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
    </style>
    <script src="https://unpkg.com/vue@3.3.4/dist/vue.global.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <div id="app">
        <div class="top-bar">
            <button @click="toggleHistoryModal">ÂéÜÂè≤ËÆ∞ÂΩï</button>
            <button @click="newConversation">+</button>
            <button @click="exportAllChatHistory">ÂØºÂá∫</button>
        </div>
        <div class="responses">
            <div v-for="entry in chatHistory" :key="entry.id" class="chat-message">
                <div v-if="entry.user" class="response">{{ entry.text }}</div>
                <button class="copy-button" @click="copyText(entry.text)">Copy</button>
                <div v-if="!entry.user" class="model-response">
                    <h3>{{ entry.model }}</h3>
                    <div class="response" v-html="entry.responseHtml"></div>
                    <button class="copy-button" @click="copyText(entry.responseHtml)">Copy</button>
                    <div class="response loading" v-if="entry.loading">Loading...</div>
                    <div class="response error" v-if="entry.error">{{ entry.error }}</div>
                </div>
            </div>
        </div>
        <div class="input-container">
            <button class="toggle-button" @click="toggleModelSelect">Models</button>
            <input type="text" v-model="question" placeholder="Type your question here" @keyup.enter="getResponses">
            <button @click="getResponses">Send</button>
        </div>
        <div class="model-select" :class="{ show: showModelSelect }">
            <label v-for="model in models" :key="model.name">
                <input type="checkbox" v-model="model.selected">
                {{ model.name }}
            </label>
            <button class="apply-button" @click="updateSelectedModels">Apply</button>
        </div>

        <div class="history-modal" :class="{ show: showHistoryModal }">
            <div class="modal-header">
                <h3>ÂéÜÂè≤ËÆ∞ÂΩï</h3>
                <button @click="toggleHistoryModal">Close</button>
            </div>
            <div class="chat-history">
                <div v-for="(history, index) in chatHistoryList" :key="index" class="history-entry">
                    <div @click="loadHistory(index)">
                        <p>{{ history.timestamp }}</p>
                        <p>{{ history.preview }}</p>
                    </div>
                    <div class="history-entry-buttons">
                        <button @click="exportSingleChatHistory(index)">ÂØºÂá∫</button>
                        <button @click="deleteChatHistory(index)">Âà†Èô§</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    question: '',
                    chatHistory: [],
                    showModelSelect: false,
                    showHistoryModal: false,
                    chatHistoryList: this.loadChatHistoryList(),
                    models: [
                        { name: "üê±KIMI", url: "https://kimiapi.xinu.ink/v1/chat/completions", key: "eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ1c2VyLWNlbnRlciIsImV4cCI6MTcyMjQ5NDY2NSwiaWF0IjoxNzE0NzE4NjY1LCJqdGkiOiJjb3E4ZmlhdG5uMHF0MzU3dGplMCIsInR5cCI6InJlZnJlc2giLCJzdWIiOiJjb2RjbHI5a3FxNG44aW12MTA5ZyIsInNwYWNlX2lkIjoiY29kY2xyOWtxcTRuOGltdjEwOTAiLCJhYnN0cmFjdF91c2VyX2lkIjoiY29kY2xyOWtxcTRuOGltdjEwOGcifQ.75yKmK85RHuBv_c-QqfhPAehqz6wW4zAzx2jBJvZq1KN23obEk9_Bt1uOoCDGiHEiEdXjiRZEUiwYUk3uIzVFw", response: '', responseHtml: '', loading: false, error: null, selected: true },
                        { name: "üêïGLM4", url: "https://glmapi.xinu.ink/v1/chat/completions", key: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTcxNDk1ODYwNSwianRpIjoiMGE2OWY2OTktYmQxZS00MWJmLWE5YzQtNTU5NDA3MWQ2MmY3IiwidHlwZSI6InJlZnJlc2giLCJzdWIiOiJkZGQ1MGUxMDAwYzk0OWNjYmY2ZDM3ZTNjNmViMTk1ZSIsIm5iZiI6MTcxNDk1ODYwNSwiZXhwIjoxNzMwNTEwNjA1LCJ1aWQiOiI2NjM4MzEwYzRkNTEwYmQ5ZWZhNGFiNGYiLCJ1cGxhdGZvcm0iOiJwYyIsInJvbGVzIjpbInVuYXV0aGVkX3VzZXIiXX0.agFeK5NnkIdMwEZ5CYmZYxP4SMg2kF42IvsOnE4B778", response: '', responseHtml: '', loading: false, error: null, selected: true },
                        { name: "üí™üèªBing", url: "https://bing.xinu.ink/v1/chat/completions", key: "YOUR_CLAUDE3_API_KEY", response: '', responseHtml: '', loading: false, error: null, selected: true },
                        { name: "üß†META", url: "https://metaapi.xinu.ink/v1/chat/completions", key: "6616d1b3d0fd75295d361294-87117fd8c70d4cc6a450e60283101feb", response: '', responseHtml: '', loading: false, error: null, selected: true },
                        { name: "üêöÁ•ûÂ•áÊµ∑Ëû∫", url: "https://abcapi.xinu.ink/v1/chat/completions", key: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTg0MTY2NTAsInVzZXIiOnsiaWQiOiIyNDMwNjkyMjcwMTkyMDI1NjIiLCJuYW1lIjoi5bCP6J665bi9MjU2MiIsImF2YXRhciI6Imh0dHBzOi8vY2RuLnlpbmdzaGktYWkuY29tL3Byb2QvdXNlcl9hdmF0YXIvMTcwNjI2NzcxMTI4Mjc3MDg3Mi0xNzMxOTQ1NzA2Njg5NjU4OTZvdmVyc2l6ZS5wbmciLCJkZXZpY2VJRCI6IjI0MzA2OTIyNDI5NzEwMzM2NSIsImlzQW5vbnltb3VzIjpmYWxzZX19.iYnKMi4zQ38F9TxPJvVkjCCgWaRnYNNQlpUhKnMfOQk", response: '', responseHtml: '', loading: false, error: null, selected: true },
                        { name: "Claude-3 Opus", url: "YOUR_CLAUDE3_API_URL", key: "YOUR_CLAUDE3_API_KEY", response: '', responseHtml: '', loading: false, error: null, selected: true },
                        // Add other models here
                    ],
                    selectedModels: []
                };
            },
            methods: {
                toggleModelSelect() {
                    this.showModelSelect = !this.showModelSelect;
                },
                updateSelectedModels() {
                    this.selectedModels = this.models.filter(model => model.selected);
                    this.showModelSelect = false;
                    this.saveSelectedModels();
                },
                saveSelectedModels() {
                    localStorage.setItem('selectedModels', JSON.stringify(this.selectedModels.map(model => model.name)));
                },
                loadSelectedModels() {
                    const savedModels = JSON.parse(localStorage.getItem('selectedModels'));
                    if (savedModels) {
                        this.models.forEach(model => {
                            model.selected = savedModels.includes(model.name);
                        });
                        this.updateSelectedModels();
                    }
                },
                async getResponses() {
                    const question = this.question.trim();
                    if (!question) return;

                    const userEntry = { id: Date.now(), text: question, user: true };
                    this.chatHistory.push(userEntry);
                    this.saveChatHistory(); // Automatically save chat history when a question is asked
                    this.question = '';

                    this.selectedModels.forEach(model => {
                        const entry = { id: Date.now() + Math.random(), model: model.name, loading: true, responseHtml: '' };
                        this.chatHistory.push(entry);
                        this.fetchResponse(model, question, entry);
                    });
                },
                async fetchResponse(model, question, entry) {
                    try {
                        const response = await fetch(model.url, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${model.key}`
                            },
                            body: JSON.stringify({
                                model: 'kimi',
                                messages: [
                                    {
                                        role: 'user',
                                        content: question
                                    }
                                ],
                                use_search: false,
                                stream: false
                            })
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const data = await response.json();
                        
                        if (data.choices && data.choices.length > 0) {
                            entry.responseHtml = marked.parse(data.choices[0].message.content);
                        } else {
                            throw new Error("Invalid response structure");
                        }

                        entry.loading = false;
                    } catch (error) {
                        entry.error = 'Error fetching response: ' + error.message;
                        entry.loading = false;
                    }
                },
                copyText(text) {
                    const textArea = document.createElement('textarea');
                    textArea.value = text;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                },
                toggleHistoryModal() {
                    this.showHistoryModal = !this.showHistoryModal;
                },
                loadChatHistoryList() {
                    const historyList = JSON.parse(localStorage.getItem('chatHistoryList')) || [];
                    return historyList.map(history => ({
                        timestamp: history.timestamp,
                        preview: history.chatHistory.length > 0 ? history.chatHistory[0].text : ''
                    }));
                },
                saveChatHistory() {
    const chatHistoryList = JSON.parse(localStorage.getItem('chatHistoryList')) || [];
    // Ê£ÄÊü•ËÅäÂ§©ËÆ∞ÂΩïÊòØÂê¶Ëá≥Â∞ëÂåÖÂê´‰∏ÄÊù°Áî®Êà∑ÊàñÊú∫Âô®‰∫∫ÁöÑÊúâÊïàÊ∂àÊÅØ
    const hasValidEntry = this.chatHistory.some(entry => {
        return (entry.user && entry.text.trim() !== '') || (!entry.user && entry.responseHtml);
    });
    if (hasValidEntry) {
        chatHistoryList.push({
            timestamp: new Date().toLocaleString(),
            chatHistory: this.chatHistory
        });
        localStorage.setItem('chatHistoryList', JSON.stringify(chatHistoryList));
        this.chatHistoryList = this.loadChatHistoryList();
    }
},
        localStorage.setItem('chatHistoryList', JSON.stringify(chatHistoryList));
        this.chatHistoryList = this.loadChatHistoryList();
    }
},
                    chatHistoryList.push({
                        timestamp: new Date().toLocaleString(),
                        chatHistory: this.chatHistory
                    });
                    localStorage.setItem('chatHistoryList', JSON.stringify(chatHistoryList));
                    this.chatHistoryList = this.loadChatHistoryList();
                },
                loadHistory(index) {
                    const chatHistoryList = JSON.parse(localStorage.getItem('chatHistoryList'));
                    this.chatHistory = chatHistoryList[index].chatHistory;
                    this.toggleHistoryModal();
                },
                newConversation() {
                    if (this.chatHistory.length === 0 || (this.chatHistory.length === 1 && !this.chatHistory[0].text.trim())) {
                        alert('‰∏çËÉΩÊñ∞Âª∫‰∏Ä‰∏™Á©∫ÁôΩÁöÑËÅäÂ§©ËÆ∞ÂΩïÔºÅ');
                        return; // Prevent creating a new conversation if the current one is empty or contains only one empty entry
                    }
                    this.saveChatHistory();
                    this.chatHistory = [];
                },
                exportChatHistory() {
                    let text = '';
                    this.chatHistory.forEach(entry => {
                        if (entry.user) {
                            text += `User: ${entry.text}\n`;
                        } else {
                            text += `Model (${entry.model}): ${entry.responseHtml.replace(/<[^>]+>/g, '')}\n`;
                        }
                    });
                    const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'chat_history.txt';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                },
                exportAllChatHistory() {
                    const historyList = JSON.parse(localStorage.getItem('chatHistoryList')) || [];
                    let text = '';
                    historyList.forEach(history => {
                        history.chatHistory.forEach(entry => {
                            if (entry.user) {
                                text += `User: ${entry.text}\n`;
                            } else {
                                text += `Model (${entry.model}): ${entry.responseHtml.replace(/<[^>]+>/g, '')}\n`;
                            }
                        });
                        text += '\n';
                    });
                    const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'all_chat_history.txt';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                },
                exportSingleChatHistory(index) {
                    const chatHistoryList = JSON.parse(localStorage.getItem('chatHistoryList'));
                    const chatHistory = chatHistoryList[index].chatHistory;
                    let text = '';
                    chatHistory.forEach(entry => {
                        if (entry.user) {
                            text += `User: ${entry.text}\n`;
                        } else {
                            text += `Model (${entry.model}): ${entry.responseHtml.replace(/<[^>]+>/g, '')}\n`;
                        }
                    });
                    const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `chat_history_${index}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                },
                deleteChatHistory(index) {
                    let chatHistoryList = JSON.parse(localStorage.getItem('chatHistoryList'));
                    chatHistoryList.splice(index, 1);
                    localStorage.setItem('chatHistoryList', JSON.stringify(chatHistoryList));
                    this.chatHistoryList = this.loadChatHistoryList();
                }
            },
            mounted() {
                this.loadSelectedModels();
            }
        }).mount('#app');
    </script>
</body>
</html>